# IceMail

## U.S. Geological Survey Alaska Science Center 
## R script for email delivery of sea ice imagery and charts to users with limited bandwidth.

Pacific walruses (Odobenus rosmarus divergens) are using coastal haulouts in the Chukchi Sea more often and in larger numbers to rest between foraging bouts in late summer and autumn in recent years, because climate warming has reduced availability of sea ice that historically had provided resting platforms near their preferred benthic feeding grounds. With greater numbers of walruses hauling out in large aggregations, new opportunities are presented for monitoring the population. This repository represents an effort to enable walrus haulout monitoring and access of sea ice charts and imagery in support of daily logistics planning where internet bandwidth and geoprocessing abilities are limited.

## Usage

We identify and create our area of interest.
![land_ptolemy](https://user-images.githubusercontent.com/91477408/225640942-db725950-23ab-4dd3-a610-b5f8286d6ed1.png)

We then project the marginal sea ice onto our study area. 
![pl_projected_bath](https://user-images.githubusercontent.com/91477408/225640976-e02f161b-1ef8-4be7-aaf0-eb8a5638d533.png)

... words, words, words, info, info, info, picture, picture, picture. 

## Technologies
- R (https://www.r-project.org/)

## Build
1. Download and install R (https://cran.r-project.org/)
2. Install the following R contributed packages: marmap, plotKML(?), terra, rgeos(?), rgdal(?), sendmailR, sf, dplyr, ggplot2, ptolemy.

## File organization
The following directory structure must be in place.
* ..\SendSeaIceData\rCode 	[contains r script, base html email text and files used in processing of bathymetry]
* ..\SendSeaIceData\Work 	[recieves compressed kml files generated by the script and staged for email delivery]
 
## File dependency
* ..\rCode\UserData.csv [Coma seperated value tabulation of user data, consisting of the following column headings: eMailServer, Sender, SenderAltEmail, GISPantryLocation, netWorkFlagBase, followed by a carriage return.  In the second row values for each column are provided as unquoted text. The vlaue for eMailServer is in the form of a url (xxxx.xxxx.xxx); the value of Sender and SenderAltEmail is in the form of an email address (name@server.xxx); the value of GISPantryLocation and netWorkFlagBase are in the form of a network address (//fileserver/directory/subdirectory/..) ]
* ..\rCode\Recipients.csv [Coma seperated value tabulation of email recipient addresses (field name = 'Recipients') indicating whether they should recieve the full data email (getData = 1, 0 otherwise); and whether they should only recieve a mailing every Monday (Monday = 1, 0 otherwise)]
* ..\rCode\RecipientsTesting.csv [Coma seperated value tabulation of email recipient addresses (field name = 'Recipients') with only the addresses of individual who are to receive the mailing during script testing efforts]
* ..\rCode\large_USGS_vector_green.png [Portable Network Graphic file representing the USGS visual identify logo]
* ETOPO1.rData [This file contains bathymetry data built by the marmap package]
* marmap_coord_-120;47;160;85_res_10_anti.csv data used in generating the ETOPO1 dataset by marmap.

## Copyright
This software is in the public domain because it contains materials that originally came from the United States Geological Survey, an agency of the United States Department of Interior. For more information, see the official USGS copyright policy at http://www.usgs.gov/visual-id/credit_usgs.html#copyright

## Approved software
This software has been approved for release by the U.S. Geological Survey (USGS). Although the software has been subjected to rigorous review, the USGS reserves the right to update the software as needed pursuant to further analysis and review. No warranty, expressed or implied, is made by the USGS or the U.S. Government as to the functionality of the software and related material nor shall the fact of release constitute any such warranty. Furthermore, the software is released on condition that neither the USGS nor the U.S. Government shall be held liable for any damages resulting from its authorized or unauthorized use.  For more information, refer to IM OSQI 2015-03 (https://www2.usgs.gov/usgs-manual/im/IM-OSQI-2015-03.html) and IM OSQI 2015-05.
